#!/bin/sh
set -e

setup_base_dir=$(dirname $0)
. "${setup_base_dir}/setup_scripts/shared.sh"

############### PRE-SETUP ##################

if [ "$EUID" -eq 0 ]; then
  echo "Run this as your normal user, not root"
  exit 1
fi

# modern laptop screen and boot media kernel mode == teeeeeensy fonts
console_font="latarcyrheb-sun32"
setfont "${console_font}.psfu.gz"
cat /etc/vconsole.conf | grep -v '^FONT= ' | printf 'FONT="%s"\n' "$console_font" | sudo dd of=/etc/vconsole.conf.new
sudo mv /etc/vconsole.conf.new /etc/vconsole.conf
sudo systemctl restart systemd-vconsole-setup

############### MAIN SETUP ##################

"${setup_base_dir}/setup_scripts/sudoers.sh"
"${setup_base_dir}/setup_scripts/packages.sh"
"${setup_base_dir}/setup_scripts/home.sh"
"${setup_base_dir}/setup_scripts/mullvad.sh"
"${setup_base_dir}/setup_scripts/systemd.sh"
